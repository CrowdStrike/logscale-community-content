name: CVE-2025-42701 and CVE-2025-42706 MSSP Dashboard
updateFrequency: never
timeSelector: {}
sharedTimeInterval:
  enabled: true
  isLive: false
  start: 7d
widgets:
  8a30c035-f299-4f70-94f7-cea8ef5b98a0:
    x: 0
    y: 6
    description: Updates every few hours.
    height: 7
    queryString: "/*\nThe following query looks for Falcon Sensor for Windows versions\
      \ that need\nto be hotfixed or updated to address CVE-2025-42701 and CVE-2025-42706\n\
      \ */\n\n// Restrict search to Windows systems in AID Master\n| readFile([aid_master_main.csv])\n\
      | event_platform=Win\n| cid=?cid\n\n// Parse AgentVersion into individual components\
      \ for evaluation\n| AgentVersion=/^(?<majorVersion>\\d+)\\.(?<minorVersion>\\\
      d+)\\.(?<buildNumber>\\d+)\\./\n\n// Check for updated version\n| case {\n \
      \     // Handles 8+\n      majorVersion>7                                  \
      \  | Status:=\"OK\";\n      // Handles 7.29+\n      majorVersion=7 minorVersion>28\
      \                    | Status:=\"OK\";\n      // Handles 7.28\n      majorVersion=7\
      \ minorVersion=28 buildNumber<=20006 | Status:=\"HOTFIX AVAILABLE\";\n     \
      \ majorVersion=7 minorVersion=28 buildNumber>=20008 | Status:=\"OK\";\n    \
      \  // Handles 7.27\n      majorVersion=7 minorVersion=27 buildNumber<=19907\
      \ | Status:=\"HOTFIX AVAILABLE\";\n      majorVersion=7 minorVersion=27 buildNumber>=19909\
      \ | Status:=\"OK\";\n      // Handles 7.26\n      majorVersion=7 minorVersion=26\
      \ buildNumber<=19811 | Status:=\"HOTFIX AVAILABLE\";\n      majorVersion=7 minorVersion=26\
      \ buildNumber>=19813 | Status:=\"OK\";\n      // Hanldes 7.25\n      majorVersion=7\
      \ minorVersion=25 buildNumber<=19706 | Status:=\"HOTFIX AVAILABLE\";\n     \
      \ majorVersion=7 minorVersion=25 buildNumber>=19707 | Status:=\"OK\";\n    \
      \  // Handles 7.24\n      majorVersion=7 minorVersion=24 buildNumber<=19607\
      \ | Status:=\"HOTFIX AVAILABLE\";\n      majorVersion=7 minorVersion=24 buildNumber>=19600\
      \ | Status:=\"OK\";\n      // Handles 7.16 Windows 7\n      majorVersion=7 minorVersion=16\
      \ buildNumber<=18635 | Status:=\"HOTFIX AVAILABLE\";\n      majorVersion=7 minorVersion=16\
      \ buildNumber>=18637 | Status:=\"OK\";\n      // Handles all other 7 versions\n\
      \      majorVersion=7 minorVersion<24  | Status:=\"OUT OF SUPPORT - UPDATE SENSOR\"\
      ;\n      // Handles all other versions\n      majorVersion<7               \
      \   | Status:=\"OUT OF SUPPORT - UPDATE SENSOR\";\n      // Catch all for logic\
      \ errors\n\t  * | Status:=\"UNKNOWN\";\n}\n\n// Add CID Name\n| join(query={$falcon/investigate:cid_name()},\
      \ field=[cid], include=[name], mode=left, start=1d)\n\n\n// Aggregate results\n\
      | groupBy([name, aid], function=([selectLast([AgentVersion, PrimaryVersion,\
      \ Status])]), limit=max)\n\n// Aggregate again for bar chart\n| groupBy([name,\
      \ Status])\n\n| Status=?Status"
    end: now
    start: 7d
    width: 12
    options:
      enableTrellis: true
      legend: false
    visualization: pie-chart
    title: Status by Version
    isLive: false
    type: query
  785821ad-69f5-4f28-8328-a13d3387c08c:
    x: 0
    y: 13
    description: Updates every few hours
    height: 6
    queryString: "/*\nThe following query looks for Falcon Sensor for Windows versions\
      \ that need\nto be hotfixed or updated to address CVE-2025-42701 and CVE-2025-42706\n\
      \ */\n\n// Restrict search to Windows systems in AID Master\n| readFile([aid_master_main.csv])\n\
      | event_platform=Win\n| cid=?cid\n\n// Parse AgentVersion into individual components\
      \ for evaluation\n| AgentVersion=/^(?<majorVersion>\\d+)\\.(?<minorVersion>\\\
      d+)\\.(?<buildNumber>\\d+)\\./\n\n// Check for updated version\n| case {\n \
      \     // Handles 8+\n      majorVersion>7                                  \
      \  | Status:=\"OK\";\n      // Handles 7.29+\n      majorVersion=7 minorVersion>28\
      \                    | Status:=\"OK\";\n      // Handles 7.28\n      majorVersion=7\
      \ minorVersion=28 buildNumber<=20006 | Status:=\"HOTFIX AVAILABLE\";\n     \
      \ majorVersion=7 minorVersion=28 buildNumber>=20008 | Status:=\"OK\";\n    \
      \  // Handles 7.27\n      majorVersion=7 minorVersion=27 buildNumber<=19907\
      \ | Status:=\"HOTFIX AVAILABLE\";\n      majorVersion=7 minorVersion=27 buildNumber>=19909\
      \ | Status:=\"OK\";\n      // Handles 7.26\n      majorVersion=7 minorVersion=26\
      \ buildNumber<=19811 | Status:=\"HOTFIX AVAILABLE\";\n      majorVersion=7 minorVersion=26\
      \ buildNumber>=19813 | Status:=\"OK\";\n      // Hanldes 7.25\n      majorVersion=7\
      \ minorVersion=25 buildNumber<=19706 | Status:=\"HOTFIX AVAILABLE\";\n     \
      \ majorVersion=7 minorVersion=25 buildNumber>=19707 | Status:=\"OK\";\n    \
      \  // Handles 7.24\n      majorVersion=7 minorVersion=24 buildNumber<=19607\
      \ | Status:=\"HOTFIX AVAILABLE\";\n      majorVersion=7 minorVersion=24 buildNumber>=19600\
      \ | Status:=\"OK\";\n      // Handles 7.16 Windows 7\n      majorVersion=7 minorVersion=16\
      \ buildNumber<=18635 | Status:=\"HOTFIX AVAILABLE\";\n      majorVersion=7 minorVersion=16\
      \ buildNumber>=18637 | Status:=\"OK\";\n      // Handles all other 7 versions\n\
      \      majorVersion=7 minorVersion<24  | Status:=\"OUT OF SUPPORT - UPDATE SENSOR\"\
      ;\n      // Handles all other versions\n      majorVersion<7               \
      \   | Status:=\"OUT OF SUPPORT - UPDATE SENSOR\";\n      // Catch all for logic\
      \ errors\n\t  * | Status:=\"UNKNOWN\";\n}\n\n// Add CID Name\n| join(query={$falcon/investigate:cid_name()},\
      \ field=[cid], include=[name], mode=left, start=1d)\n\n// Modify field names\
      \ for easier reading\n| rename([[name, \"Customer\"], [cid, \"Customer ID\"\
      ],[aid, \"Agent ID\"], [event_platform, Platform], [aip, \"External IP\"]])\n\
      \n// Aggregate results into tabular format with cleaner ordering\n| groupBy([Customer,\
      \ \"Customer ID\", ComputerName, \"Agent ID\", Platform, Version, AgentVersion,\
      \ Status, \"External IP\", LocalAddressIP4, MAC, SystemManufacturer, SystemProductName,\
      \ FirstSeen, Time], function=[], limit=max)\n\n// Set default values for easier\
      \ reading\n| default(value=\"-\", field=[Customer, ComputerName, Version, AgentVersion,\
      \ Status, LocalAddressIP4, MAC, SystemManufacturer, SystemProductName, FirstSeen,\
      \ Time], replaceEmpty=true)\n\n// Move timestamps from epoch to human readable\n\
      | formatTime(format=\"%F %T\", as=\"FirstSeen\", field=FirstSeen)\n| formatTime(format=\"\
      %F %T\", as=\"LastSeen\", field=Time)\n\n// Remove unnecessary field\n| drop([Time])\n\
      | Status=?Status"
    end: now
    start: 7d
    width: 12
    options:
      cell-overflow: wrap-text
      configured-columns:
        Status:
          color:
            conditions:
            - color: '#C93637'
              condition:
                arg: OUT OF SUPPORT - UPDATE SENSOR
                type: Equal
            - color: '#f59464ff'
              condition:
                arg: HOTFIX AVAILABLE
                type: Equal
            - color: '#29a34bff'
              condition:
                arg: OK
                type: Equal
            defaultColor: '#126CC6FF'
      row-numbers-enabled: true
    visualization: table-view
    title: System Inventory
    isLive: false
    type: query
  cac5f203-a3dd-445e-a966-714a9ed10f99:
    x: 0
    y: 2
    height: 4
    queryString: |
      /*
      The following query looks for Falcon Sensor for Windows versions that need
      to be hotfixed or updated to address CVE-2025-42701 and CVE-2025-42706
       */

      // Restrict search to Windows systems in AID Master
      | readFile([aid_master_main.csv])
      | event_platform=Win
      | cid=?cid

      // Parse AgentVersion into individual components for evaluation
      | AgentVersion=/^(?<majorVersion>\d+)\.(?<minorVersion>\d+)\.(?<buildNumber>\d+)\./

      // Aggregate Versions
      | groupBy([AgentVersion], function=(count(aid, as=Endpoints)))
      | [sum(Endpoints, as=total), sort(field=Endpoints, order=ascending, limit=20000)]
      | Percent := 100 * (Endpoints / total)
      | Percent := round("Percent")
      | format(format="%s%%", field=[Percent], as=Percent)
      | drop([total])
      | sort(order=desc, Endpoints)
    end: now
    start: 7d
    width: 6
    options:
      cell-overflow: wrap-text
      configured-columns:
        Status:
          color:
            conditions:
            - color: '#C93637'
              condition:
                arg: OUT OF SUPPORT - UPDATE SENSOR
                type: Equal
            - color: '#f59464ff'
              condition:
                arg: HOTFIX AVAILABLE
                type: Equal
            - color: '#29a34bff'
              condition:
                arg: OK
                type: Equal
            defaultColor: '#126CC6FF'
      row-numbers-enabled: true
    visualization: table-view
    title: Windows Sensor Distribution
    isLive: false
    type: query
  68334a4b-eeae-4f6c-ba7f-479befe0b945:
    x: 6
    y: 2
    height: 4
    queryString: "/*\nThe following query looks for Falcon Sensor for Windows versions\
      \ that need\nto be hotfixed or updated to address CVE-2025-42701 and CVE-2025-42706\n\
      \ */\n\n// Restrict search to Windows systems in AID Master\n| readFile([aid_master_main.csv])\n\
      | event_platform=Win\n| cid=?cid\n\n// Parse AgentVersion into individual components\
      \ for evaluation\n| AgentVersion=/^(?<majorVersion>\\d+)\\.(?<minorVersion>\\\
      d+)\\.(?<buildNumber>\\d+)\\./\n\n// Check for updated version\n| case {\n \
      \     // Handles 8+\n      majorVersion>7                                  \
      \  | Status:=\"OK\";\n      // Handles 7.29+\n      majorVersion=7 minorVersion>28\
      \                    | Status:=\"OK\";\n      // Handles 7.28\n      majorVersion=7\
      \ minorVersion=28 buildNumber<=20006 | Status:=\"HOTFIX AVAILABLE\";\n     \
      \ majorVersion=7 minorVersion=28 buildNumber>=20008 | Status:=\"OK\";\n    \
      \  // Handles 7.27\n      majorVersion=7 minorVersion=27 buildNumber<=19907\
      \ | Status:=\"HOTFIX AVAILABLE\";\n      majorVersion=7 minorVersion=27 buildNumber>=19909\
      \ | Status:=\"OK\";\n      // Handles 7.26\n      majorVersion=7 minorVersion=26\
      \ buildNumber<=19811 | Status:=\"HOTFIX AVAILABLE\";\n      majorVersion=7 minorVersion=26\
      \ buildNumber>=19813 | Status:=\"OK\";\n      // Hanldes 7.25\n      majorVersion=7\
      \ minorVersion=25 buildNumber<=19706 | Status:=\"HOTFIX AVAILABLE\";\n     \
      \ majorVersion=7 minorVersion=25 buildNumber>=19707 | Status:=\"OK\";\n    \
      \  // Handles 7.24\n      majorVersion=7 minorVersion=24 buildNumber<=19607\
      \ | Status:=\"HOTFIX AVAILABLE\";\n      majorVersion=7 minorVersion=24 buildNumber>=19600\
      \ | Status:=\"OK\";\n      // Handles 7.16 Windows 7\n      majorVersion=7 minorVersion=16\
      \ buildNumber<=18635 | Status:=\"HOTFIX AVAILABLE\";\n      majorVersion=7 minorVersion=16\
      \ buildNumber>=18637 | Status:=\"OK\";\n      // Handles all other 7 versions\n\
      \      majorVersion=7 minorVersion<24  | Status:=\"OUT OF SUPPORT - UPDATE SENSOR\"\
      ;\n      // Handles all other versions\n      majorVersion<7               \
      \   | Status:=\"OUT OF SUPPORT - UPDATE SENSOR\";\n      // Catch all for logic\
      \ errors\n\t  * | Status:=\"UNKNOWN\";\n}\n// Aggregate Status\n| groupBy([Status],\
      \ function=(count(aid, as=Endpoints)))\n| [sum(Endpoints, as=total), sort(field=Endpoints,\
      \ order=ascending, limit=20000)]\n| Percent := 100 * (Endpoints / total)\n|\
      \ Percent := round(\"Percent\")\n| sort(Endpoints, order=desc)\n| format(format=\"\
      %s%%\", field=[Percent], as=Percent)\n| drop([total])\n| Status=?Status"
    end: now
    start: 7d
    width: 6
    options:
      cell-overflow: wrap-text
      configured-columns:
        Status:
          color:
            conditions:
            - color: '#C93637'
              condition:
                arg: OUT OF SUPPORT - UPDATE SENSOR
                type: Equal
            - color: '#f59464ff'
              condition:
                arg: HOTFIX AVAILABLE
                type: Equal
            - color: '#29a34bff'
              condition:
                arg: OK
                type: Equal
            defaultColor: '#126CC6FF'
      row-numbers-enabled: true
    visualization: table-view
    title: Distribution by Status
    isLive: false
    type: query
  note-1759506172069-0:
    x: 0
    y: 0
    height: 2
    text: 'The following dashboard leverages data from the "AID Master" lookup table.
      The dashboard will update automatically every four hours. '
    width: 12
    title: About Dashboard
    type: note
$schema: https://schemas.humio.com/dashboard/v0.19.0
parameters:
  Status:
    label: Status
    order: 50
    values:
      '*': All
      OK: OK
      HOTFIX AVAILABLE: HOTFIX AVAILABLE
      OUT OF SUPPORT - UPDATE SENSOR: UPDATE
      UNKNOWN: UNKNOWN
    type: list
    defaultValue: '*'
    width: 1
  cid:
    label: CID
    query: $falcon/investigate:cid_name()
    timeInterval: 1d
    useDashboardTimeIfSet: false
    defaultValue: '*'
    width: 1
    order: 50
    valueField: cid
    type: query
    labelField: name
