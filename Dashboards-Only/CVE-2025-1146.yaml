name: CVE-2025-1146
updateFrequency: never
timeSelector: {}
sharedTimeInterval:
  enabled: false
  isLive: false
  start: 7d
widgets:
  0e3b6aa4-3f72-4bd7-9778-41edba796bfe:
    x: 0
    description: This data updates every ~4 hours
    height: 10
    queryString: |-
      // Read in AID Master file
      | readFile("aid_master_main.csv")
      | cid=?cid
      | in(aid, values=[?aid], ignoreCase=true)

      // Restrict aid_master to just the time window in the time picker
      | test(Time > start())
      | test(Time < end())

      // Narrow search to only include Linux and K8 systems
      | in(field="event_platform", values=[Lin, K8S])

      // Parse AgentVersion into individual components for evaluation
      | AgentVersion=/^(?<majorVersion>\d+)\.(?<minorVersion>\d+)\.(?<buildNumber>\d+)\./

      // Evaluate Linux Container Sensors
      | case {
          event_platform=Lin ProductType=Pod majorVersion=6                                 | Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion<=5                 | Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=6  buildNumber<4705| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=10 buildNumber<4907| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=11 buildNumber<5003| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=12 buildNumber<5102| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=13 buildNumber<5202| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=14 buildNumber<5306| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=15 buildNumber<5403| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=16 buildNumber<5503| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=17 buildNumber<5603| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=18 buildNumber<5705| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=19 buildNumber<5807| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=20 buildNumber<5908| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod                                                | Status:="OK"          | event_platform:="Lin (Pod)";
          *;
      }
      | in(event_platform, values=[?platform])

      // Evaluate Linux Sensors
      | case {
          event_platform=Lin majorVersion=6                                  | Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion<=5                  | Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=6 buildNumber<16113 | Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=7 buildNumber<16209 | Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=10 buildNumber<16321| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=11 buildNumber<16410| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=13 buildNumber<16606| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=14 buildNumber<16705| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=15 buildNumber<16806| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=16 buildNumber<16909| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=17 buildNumber<17014| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=18 buildNumber<17131| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=19 buildNumber<17221| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=20 buildNumber<17308| Status:="NEEDS PATCH";
          event_platform=Lin                                                 | Status:="OK";
          *;
      }
      // Evaluate K8 Sensors
      | case {
          event_platform=K8S majorVersion=6                                 | Status:="NEEDS PATCH";
          event_platform=K8S majorVersion=7 minorVersion<=5                 | Status:="NEEDS PATCH";
          event_platform=K8S majorVersion=7 minorVersion=6 buildNumber<603  | Status:="NEEDS PATCH";
          event_platform=K8S majorVersion=7 minorVersion=10 buildNumber<806 | Status:="NEEDS PATCH";
          event_platform=K8S majorVersion=7 minorVersion=11 buildNumber<904 | Status:="NEEDS PATCH";
          event_platform=K8S majorVersion=7 minorVersion=12 buildNumber<1002| Status:="NEEDS PATCH";
          event_platform=K8S majorVersion=7 minorVersion=13 buildNumber<1102| Status:="NEEDS PATCH";
          event_platform=K8S majorVersion=7 minorVersion=14 buildNumber<1203| Status:="NEEDS PATCH";
          event_platform=K8S majorVersion=7 minorVersion=16 buildNumber<1403| Status:="NEEDS PATCH";
          event_platform=K8S majorVersion=7 minorVersion=17 buildNumber<1503| Status:="NEEDS PATCH";
          event_platform=K8S majorVersion=7 minorVersion=18 buildNumber<1605| Status:="NEEDS PATCH";
          event_platform=K8S majorVersion=7 minorVersion=20 buildNumber<1808| Status:="NEEDS PATCH";
          event_platform=K8S                                                | Status:="OK";
          *;
      }
      | Status=?status

      // Change several field names
      | rename([[cid, "Customer ID"],[aid, "Agent ID"], [event_platform, Platform], [aip, "External IP"]])

      // Aggregate results into tabular format
      | groupBy(["Customer ID", "Agent ID", ComputerName, Platform, Version, AgentVersion, Status, "External IP", LocalAddressIP4, MAC, SystemManufacturer, SystemProductName, FirstSeen, Time], function=[], limit=max)

      // Set default values for ease of reading
      | default(value="-", field=[ComputerName, Version, AgentVersion, Status, LocalAddressIP4, MAC, SystemManufacturer, SystemProductName, FirstSeen, Time], replaceEmpty=true)

      // Move timestamps from epoch to human readable
      | FirstSeen_UTC_readable := formatTime("%FT%T%z", field=FirstSeen)
      | LastSeen_UTC_readable := formatTime("%FT%T%z", field=Time)
      | LastSeen := rename(Time)
    end: now
    start: 45d
    width: 12
    y: 4
    interactions:
    - name: RTR
      urlEncodeArgs: true
      titleTemplate: Connect to host via RTR
      urlTemplate: /real-time-response/console?start=hosts&aid={{ fields["Agent ID"]
        }}
      openInNewTab: true
      type: customlink
    - name: Host Management
      urlEncodeArgs: true
      titleTemplate: View host in host management
      urlTemplate: /host-management/hosts/{{ fields["Agent ID"] }}
      openInNewTab: true
      type: customlink
    - conditions:
      - argument: Lin
        fieldName: Platform
        operator: equal
      name: Asset Details
      urlEncodeArgs: true
      titleTemplate: View host in asset details
      urlTemplate: /asset-details/managed/{{ fields["Agent ID"] }}
      openInNewTab: true
      type: customlink
    - name: Latest information from OsVersionInfo
      urlEncodeArgs: true
      titleTemplate: Investigate with OsVersionInfo
      urlTemplate: /investigate/search?isLive=false&query=defineTable(query%3D%7B%0A%20%20%20%20%2F%2F%20Get%20OsVersionInfo%20events%0A%20%20%20%20%23event_simpleName%3D%22OsVersionInfo%22%20cid%3D"{{
        parameters.cid }}"%0A%20%20%20%20%7C%20in(aid%2C%20values%3D%5B{{ fields["Agent
        ID"] }}%5D%2C%20ignoreCase%3Dtrue)%0A%0A%20%20%20%20%2F%2F%20Narrow%20search%20to%20only%20include%20Linux%20and%20K8%20systems%0A%20%20%20%20%7C%20in(field%3D%22event_platform%22%2C%20values%3D%5BLin%2C%20K8s%5D)%0A%0A%20%20%20%20%2F%2F%20Select%20the%20latest%20information%20for%20each%20aid%0A%20%20%20%20%7C%20groupBy(aid%2C%20function%3DselectLast(%5BAgentVersion%2C%20%40timestamp%5D)%2C%20limit%3Dmax)%0A%20%20%20%20%7C%20Time%20%3A%3D%20rename(%40timestamp)%0A%7D%2C%20include%3D%5Baid%2C%20AgentVersion%2C%20Time%5D%2C%20start%3D12h%2C%20name%3D%22subsearch_osversioninfo%22)%0A%0A%2F%2F%20Read%20in%20AID%20Master%20file%0A%7C%20readFile(%22aid_master_main.csv%22)%0A%7C%20cid%3D"{{
        parameters.cid }}"%0A%7C%20in(aid%2C%20values%3D%5B{{ fields["Agent ID"] }}%5D%2C%20ignoreCase%3Dtrue)%0A%0A%2F%2F%20Restrict%20aid_master%20to%20just%20the%20time%20window%20in%20the%20time%20picker%0A%7C%20test(Time%20%3E%20start())%0A%7C%20test(Time%20%3C%20end())%0A%0A%2F%2F%20Narrow%20search%20to%20only%20include%20Linux%20and%20K8%20systems%0A%7C%20in(field%3D%22event_platform%22%2C%20values%3D%5BLin%2C%20K8S%5D)%0A%0A%2F%2F%20Grab%20most%20up%20to%20date%20AgentVersion%0A%7C%20match(subsearch_osversioninfo%2C%20field%3Daid%2C%20include%3D%5BAgentVersion%2C%20Time%5D%2C%20strict%3Dfalse)%0A%0A%2F%2F%20Parse%20AgentVersion%20into%20individual%20components%20for%20evaluation%0A%7C%20AgentVersion%3D%2F%5E(%3F%3CmajorVersion%3E%5Cd%2B)%5C.(%3F%3CminorVersion%3E%5Cd%2B)%5C.(%3F%3CbuildNumber%3E%5Cd%2B)%5C.%2F%0A%0A%2F%2F%20Evaluate%20Linux%20Container%20Sensors%0A%7C%20case%20%7B%0A%20%20%20%20event_platform%3DLin%20ProductType%3DPod%20majorVersion%3D6%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Status%3A%3D%22NEEDS%20PATCH%22%20%7C%20event_platform%3A%3D%22Lin%20(Pod)%22%3B%0A%20%20%20%20event_platform%3DLin%20ProductType%3DPod%20majorVersion%3D7%20minorVersion%3C%3D5%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Status%3A%3D%22NEEDS%20PATCH%22%20%7C%20event_platform%3A%3D%22Lin%20(Pod)%22%3B%0A%20%20%20%20event_platform%3DLin%20ProductType%3DPod%20majorVersion%3D7%20minorVersion%3D6%20%20buildNumber%3C4705%7C%20Status%3A%3D%22NEEDS%20PATCH%22%20%7C%20event_platform%3A%3D%22Lin%20(Pod)%22%3B%0A%20%20%20%20event_platform%3DLin%20ProductType%3DPod%20majorVersion%3D7%20minorVersion%3D10%20buildNumber%3C4907%7C%20Status%3A%3D%22NEEDS%20PATCH%22%20%7C%20event_platform%3A%3D%22Lin%20(Pod)%22%3B%0A%20%20%20%20event_platform%3DLin%20ProductType%3DPod%20majorVersion%3D7%20minorVersion%3D11%20buildNumber%3C5003%7C%20Status%3A%3D%22NEEDS%20PATCH%22%20%7C%20event_platform%3A%3D%22Lin%20(Pod)%22%3B%0A%20%20%20%20event_platform%3DLin%20ProductType%3DPod%20majorVersion%3D7%20minorVersion%3D12%20buildNumber%3C5102%7C%20Status%3A%3D%22NEEDS%20PATCH%22%20%7C%20event_platform%3A%3D%22Lin%20(Pod)%22%3B%0A%20%20%20%20event_platform%3DLin%20ProductType%3DPod%20majorVersion%3D7%20minorVersion%3D13%20buildNumber%3C5202%7C%20Status%3A%3D%22NEEDS%20PATCH%22%20%7C%20event_platform%3A%3D%22Lin%20(Pod)%22%3B%0A%20%20%20%20event_platform%3DLin%20ProductType%3DPod%20majorVersion%3D7%20minorVersion%3D14%20buildNumber%3C5306%7C%20Status%3A%3D%22NEEDS%20PATCH%22%20%7C%20event_platform%3A%3D%22Lin%20(Pod)%22%3B%0A%20%20%20%20event_platform%3DLin%20ProductType%3DPod%20majorVersion%3D7%20minorVersion%3D15%20buildNumber%3C5403%7C%20Status%3A%3D%22NEEDS%20PATCH%22%20%7C%20event_platform%3A%3D%22Lin%20(Pod)%22%3B%0A%20%20%20%20event_platform%3DLin%20ProductType%3DPod%20majorVersion%3D7%20minorVersion%3D16%20buildNumber%3C5503%7C%20Status%3A%3D%22NEEDS%20PATCH%22%20%7C%20event_platform%3A%3D%22Lin%20(Pod)%22%3B%0A%20%20%20%20event_platform%3DLin%20ProductType%3DPod%20majorVersion%3D7%20minorVersion%3D17%20buildNumber%3C5603%7C%20Status%3A%3D%22NEEDS%20PATCH%22%20%7C%20event_platform%3A%3D%22Lin%20(Pod)%22%3B%0A%20%20%20%20event_platform%3DLin%20ProductType%3DPod%20majorVersion%3D7%20minorVersion%3D18%20buildNumber%3C5705%7C%20Status%3A%3D%22NEEDS%20PATCH%22%20%7C%20event_platform%3A%3D%22Lin%20(Pod)%22%3B%0A%20%20%20%20event_platform%3DLin%20ProductType%3DPod%20majorVersion%3D7%20minorVersion%3D19%20buildNumber%3C5807%7C%20Status%3A%3D%22NEEDS%20PATCH%22%20%7C%20event_platform%3A%3D%22Lin%20(Pod)%22%3B%0A%20%20%20%20event_platform%3DLin%20ProductType%3DPod%20majorVersion%3D7%20minorVersion%3D20%20buildNumber%3C5908%7C%20Status%3A%3D%22NEEDS%20PATCH%22%20%7C%20event_platform%3A%3D%22Lin%20(Pod)%22%3B%0A%20%20%20%20event_platform%3DLin%20ProductType%3DPod%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Status%3A%3D%22OK%22%20%20%20%20%20%20%20%20%20%20%7C%20event_platform%3A%3D%22Lin%20(Pod)%22%3B%0A%20%20%20%20*%3B%0A%7D%0A%2F%2F%20Evaluate%20Linux%20Sensors%0A%7C%20case%20%7B%0A%20%20%20%20event_platform%3DLin%20majorVersion%3D6%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DLin%20majorVersion%3D7%20minorVersion%3C%3D5%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DLin%20majorVersion%3D7%20minorVersion%3D6%20buildNumber%3C16113%20%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DLin%20majorVersion%3D7%20minorVersion%3D7%20buildNumber%3C16209%20%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DLin%20majorVersion%3D7%20minorVersion%3D10%20buildNumber%3C16321%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DLin%20majorVersion%3D7%20minorVersion%3D11%20buildNumber%3C16410%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DLin%20majorVersion%3D7%20minorVersion%3D13%20buildNumber%3C16606%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DLin%20majorVersion%3D7%20minorVersion%3D14%20buildNumber%3C16705%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DLin%20majorVersion%3D7%20minorVersion%3D15%20buildNumber%3C16806%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DLin%20majorVersion%3D7%20minorVersion%3D16%20buildNumber%3C16909%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DLin%20majorVersion%3D7%20minorVersion%3D17%20buildNumber%3C17014%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DLin%20majorVersion%3D7%20minorVersion%3D18%20buildNumber%3C17131%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DLin%20majorVersion%3D7%20minorVersion%3D19%20buildNumber%3C17221%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DLin%20majorVersion%3D7%20minorVersion%3D20%20buildNumber%3C17308%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DLin%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Status%3A%3D%22OK%22%3B%0A%20%20%20%20*%3B%0A%7D%0A%2F%2F%20Evaluate%20K8%20Sensors%0A%7C%20case%20%7B%0A%20%20%20%20event_platform%3DK8S%20majorVersion%3D6%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DK8S%20majorVersion%3D7%20minorVersion%3C%3D5%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DK8S%20majorVersion%3D7%20minorVersion%3D6%20buildNumber%3C603%20%20%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DK8S%20majorVersion%3D7%20minorVersion%3D10%20buildNumber%3C806%20%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DK8S%20majorVersion%3D7%20minorVersion%3D11%20buildNumber%3C904%20%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DK8S%20majorVersion%3D7%20minorVersion%3D12%20buildNumber%3C1002%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DK8S%20majorVersion%3D7%20minorVersion%3D13%20buildNumber%3C1102%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DK8S%20majorVersion%3D7%20minorVersion%3D14%20buildNumber%3C1203%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DK8S%20majorVersion%3D7%20minorVersion%3D16%20buildNumber%3C1403%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DK8S%20majorVersion%3D7%20minorVersion%3D17%20buildNumber%3C1503%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DK8S%20majorVersion%3D7%20minorVersion%3D18%20buildNumber%3C1605%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DK8S%20majorVersion%3D7%20minorVersion%3D20%20buildNumber%3C1808%7C%20Status%3A%3D%22NEEDS%20PATCH%22%3B%0A%20%20%20%20event_platform%3DK8S%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Status%3A%3D%22OK%22%3B%0A%20%20%20%20*%3B%0A%7D%0A%7C%20Status%3D"{{
        parameters.status }}"%0A%0A%2F%2F%20Change%20several%20field%20names%0A%7C%20rename(%5B%5Bcid%2C%20%22Customer%20ID%22%5D%2C%5Baid%2C%20%22Agent%20ID%22%5D%2C%20%5Bevent_platform%2C%20Platform%5D%2C%20%5Baip%2C%20%22External%20IP%22%5D%5D)%0A%0A%2F%2F%20Aggreate%20results%20into%20tabular%20format%0A%7C%20groupBy(%5B%22Customer%20ID%22%2C%20%22Agent%20ID%22%2C%20ComputerName%2C%20Platform%2C%20Version%2C%20AgentVersion%2C%20Status%2C%20%22External%20IP%22%2C%20LocalAddressIP4%2C%20MAC%2C%20SystemManufacturer%2C%20SystemProductName%2C%20FirstSeen%2C%20Time%5D%2C%20function%3D%5B%5D%2C%20limit%3Dmax)%0A%0A%2F%2F%20Set%20default%20values%20for%20ease%20of%20reading%0A%7C%20default(value%3D%22-%22%2C%20field%3D%5BComputerName%2C%20Version%2C%20AgentVersion%2C%20Status%2C%20LocalAddressIP4%2C%20MAC%2C%20SystemManufacturer%2C%20SystemProductName%2C%20FirstSeen%2C%20Time%5D%2C%20replaceEmpty%3Dtrue)%0A%0A%2F%2F%20Move%20timestamps%20from%20epoch%20to%20human%20readable%0A%7C%20FirstSeen_UTC_readable%20%3A%3D%20formatTime(%22%25FT%25T%25z%22%2C%20field%3DFirstSeen)%0A%7C%20LastSeen_UTC_readable%20%3A%3D%20formatTime(%22%25FT%25T%25z%22%2C%20field%3DTime)%0A%7C%20LastSeen%20%3A%3D%20rename(Time)&repo=all&start={{
        startTime }}&end={{ endTime }}&visualizationOptions=N4IgxgpgNlC0D2A3CAnAZleB3EAuEWKAhgA6wAuEAHuSADTjwB2aAlgOYCuKEAJrGHhROAWyYBnPKABirFOPIBlCBCZSQvIuSIUAniQh4NWiOVYjDAXwaz5SlUwD6AVQAqAYUc8imgEZRDXFAAC1ZeXlU8chROCGsQABkiBWVIoONtPQMjTUozCxB4pJSHFw8vCB8if0CQsIi1XGjY%2BPyIBSIREjLPbz8A9VDwtOa4%2BJRsWCZRX1RxWFVqgN48NCIocTigA&visualizationType=table-view
      openInNewTab: true
      type: customlink
    options:
      cell-overflow: wrap-text
      configured-columns:
        LastSeen:
          data-type: datetime
        FirstSeen:
          data-type: datetime
        LastSeen_UTC_readable:
          hidden: true
        FirstSeen_UTC_readable:
          hidden: true
        Status:
          color:
            conditions:
            - color: '#29a34bff'
              condition:
                arg: OK
                type: Equal
            defaultColor: '#C93637'
      row-numbers-enabled: true
    visualization: table-view
    title: Linux, K8s, and Container inventory
    isLive: false
    type: query
  1258fbce-e6e6-450d-8126-e4b7aa573938:
    x: 0
    y: 0
    description: As seen over past 45 days by AID Master
    height: 4
    queryString: |-
      // Read in AID Master file
      | readFile("aid_master_main.csv")
      | cid = ?cid

      // Restrict aid_master to just the time window in the time picker
      | test(Time > start())
      | test(Time < end())

      // Narrow search to only include Linux and K8 systems
      | in(field="event_platform", values=[Lin, K8S])

      | count()
    end: now
    start: 45d
    width: 4
    options:
      default: {}
    visualization: single-value
    title: Total Linux, K8s, and Container systems
    isLive: false
    type: query
  66aea036-ad74-4830-bf7a-ebb77a3ab648:
    x: 4
    y: 0
    height: 4
    queryString: |-
      // Get OsVersionInfo events
      #event_simpleName=OsVersionInfo cid=?cid
      | in(aid, values=[?aid], ignoreCase=true)

      // Narrow search to only include Linux and K8 systems
      | in(field="event_platform", values=[Lin, K8s])

      // Merge ProductType
      | match(file="aid_master_main.csv", field=[aid], column=[aid], include=[ProductType], strict=false)

      // Create Day value for later aggregation
      | Day:=formatTime(format="%F", field="@timestamp")

      // Parse AgentVersion into individual components for evaluation
      | AgentVersion=/^(?<majorVersion>\d+)\.(?<minorVersion>\d+)\.(?<buildNumber>\d+)\./

      // Evaluate Linux Container Sensors
      | case {
          event_platform=Lin ProductType=Pod majorVersion=6                                 | Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion<=5                 | Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=6  buildNumber<4705| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=10 buildNumber<4907| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=11 buildNumber<5003| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=12 buildNumber<5102| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=13 buildNumber<5202| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=14 buildNumber<5306| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=15 buildNumber<5403| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=16 buildNumber<5503| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=17 buildNumber<5603| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=18 buildNumber<5705| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=19 buildNumber<5807| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod majorVersion=7 minorVersion=20 buildNumber<5908| Status:="NEEDS PATCH" | event_platform:="Lin (Pod)";
          event_platform=Lin ProductType=Pod                                                | Status:="OK"          | event_platform:="Lin (Pod)";
          *;
      }
      | in(event_platform, values=[?platform])

      // Evaluate Linux Sensors
      | case {
          event_platform=Lin majorVersion=6                                  | Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion<=5                  | Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=6 buildNumber<16113 | Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=7 buildNumber<16209 | Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=10 buildNumber<16321| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=11 buildNumber<16410| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=13 buildNumber<16606| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=14 buildNumber<16705| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=15 buildNumber<16806| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=16 buildNumber<16909| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=17 buildNumber<17014| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=18 buildNumber<17131| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=19 buildNumber<17221| Status:="NEEDS PATCH";
          event_platform=Lin majorVersion=7 minorVersion=20 buildNumber<17308| Status:="NEEDS PATCH";
          event_platform=Lin                                                 | Status:="OK";
          *;
      }
      // Evaluate K8 Sensors
      | case {
          event_platform=K8s majorVersion=6                                 | Status:="NEEDS PATCH";
          event_platform=K8s majorVersion=7 minorVersion<=5                 | Status:="NEEDS PATCH";
          event_platform=K8s majorVersion=7 minorVersion=6 buildNumber<603  | Status:="NEEDS PATCH";
          event_platform=K8s majorVersion=7 minorVersion=10 buildNumber<806 | Status:="NEEDS PATCH";
          event_platform=K8s majorVersion=7 minorVersion=11 buildNumber<904 | Status:="NEEDS PATCH";
          event_platform=K8s majorVersion=7 minorVersion=12 buildNumber<1002| Status:="NEEDS PATCH";
          event_platform=K8s majorVersion=7 minorVersion=13 buildNumber<1102| Status:="NEEDS PATCH";
          event_platform=K8s majorVersion=7 minorVersion=14 buildNumber<1203| Status:="NEEDS PATCH";
          event_platform=K8s majorVersion=7 minorVersion=16 buildNumber<1403| Status:="NEEDS PATCH";
          event_platform=K8s majorVersion=7 minorVersion=17 buildNumber<1503| Status:="NEEDS PATCH";
          event_platform=K8s majorVersion=7 minorVersion=18 buildNumber<1605| Status:="NEEDS PATCH";
          event_platform=K8s majorVersion=7 minorVersion=20 buildNumber<1808| Status:="NEEDS PATCH";
          event_platform=K8s                                                | Status:="OK";
          *;
      }

      // Aggregate for bar chart
      | groupBy([aid, Day], function=selectLast([Status]), limit=max)
      | groupBy([Day, Status], limit=max)
    end: now
    start: 7d
    width: 8
    options:
      barChartType: stacked
      legend: true
      yAxisTitle: Linux, K8s, and Container systems
      series:
        NEEDS PATCH:
          color: '#c93638'
        OK:
          color: '#2aa34b'
    visualization: bar-chart
    title: Breakdown of system status per day
    isLive: false
    type: query
$schema: https://schemas.humio.com/dashboard/v0.17.0
parameters:
  aid:
    label: aid
    order: 2
    type: text
    defaultValue: '*'
    width: 1
  cid:
    query: $falcon/investigate:cid_name()
    timeInterval: 12h
    useDashboardTimeIfSet: false
    defaultValue: '*'
    width: 1
    order: 1
    valueField: cid
    type: query
    labelField: name
  platform:
    label: Platform
    order: 3
    values:
    - Lin
    - Lin (Pod)
    - K8S
    - '*'
    type: list
    defaultValue: '*'
    width: 1
  status:
    label: Status
    order: 4
    values:
    - NEEDS PATCH
    - OK
    - '*'
    type: list
    defaultValue: '*'
    width: 1
